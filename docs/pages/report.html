<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="../assets/icons/favicon.svg">
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="../assets/css/enhanced-pages.css">
    <title>Report Crime - Community Crime Watch</title>
</head>

<body class="report-page">
    <!-- Animated Background -->
    <div class="page-background">
        <div class="bg-shape bg-shape-1"></div>
        <div class="bg-shape bg-shape-2"></div>
        <div class="bg-shape bg-shape-3"></div>
        <div class="bg-dots"></div>
    </div>

    <nav class="modern-nav">
        <div class="main-logo">
            <img src="../assets/icons/logo.svg" alt="Logo" class="logo-pulse">
            <a href="#" id="home-link" class="logo-text">Community Crime Watch</a>
        </div>
        <div class="links">
            <a href="#" id="home-btn" class="nav-link">Home</a>
            <a href="map.html" class="nav-link">View Map</a>
            <a class="logout-btn-modern" id="logout-btn" href="#">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                    <polyline points="16 17 21 12 16 7"/>
                    <line x1="21" y1="12" x2="9" y2="12"/>
                </svg>
                <span>Log out</span>
            </a>
        </div>
    </nav>

    <div class="report-hero">
        <div class="hero-background">
            <div class="hero-circle hero-circle-1"></div>
            <div class="hero-circle hero-circle-2"></div>
        </div>
        <div class="report-hero-content">
            <div class="page-badge">
                <div class="feature-icon-wrapper blue" style="width: 50px; height: 50px; margin-bottom: 15px;">
                    <img src="../assets/icons/camera.svg" alt="Report" class="feature-icon" style="width: 28px; height: 28px;">
                </div>
            </div>
            <h1>Report a Crime</h1>
            <p>Help keep your community safe by reporting incidents. Your report will be processed immediately.</p>
        </div>
    </div>

    <div class="report-form-wrapper">
        <div id="success-message" class="success-message">
            Crime report submitted successfully! Redirecting to map...
        </div>
        <div id="error-message" class="error-message"></div>

        <form id="crime-report-form" class="report-form">
            <!-- AI Input Methods -->
            <div class="ai-input-section">
                <h3>Report Incident Using AI</h3>
                <p class="ai-subtitle">Choose how you'd like to report the incident - our AI will automatically
                    categorize it</p>

                <div class="input-method-tabs">
                    <button type="button" class="tab-btn active" data-tab="text">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z" />
                        </svg>
                        Text
                    </button>
                    <button type="button" class="tab-btn" data-tab="voice">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" />
                            <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                            <line x1="12" y1="19" x2="12" y2="23" />
                            <line x1="8" y1="23" x2="16" y2="23" />
                        </svg>
                        Voice
                    </button>
                </div>

                <!-- Text Input Tab -->
                <div class="tab-content active" id="text-tab">
                    <div class="form-group">
                        <label for="ai-description">Describe what happened</label>
                        <textarea id="ai-description"
                            placeholder="E.g., 'I saw someone breaking into a car on Main Street...'"></textarea>
                    </div>
                    <button type="button" class="ai-analyze-btn" id="analyze-text-btn">
                        <span class="btn-text">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" style="vertical-align: middle; margin-right: 5px;">
                                <circle cx="12" cy="12" r="10" />
                                <circle cx="12" cy="12" r="3" />
                                <line x1="12" y1="2" x2="12" y2="6" />
                                <line x1="12" y1="18" x2="12" y2="22" />
                                <line x1="4.93" y1="4.93" x2="7.76" y2="7.76" />
                                <line x1="16.24" y1="16.24" x2="19.07" y2="19.07" />
                                <line x1="2" y1="12" x2="6" y2="12" />
                                <line x1="18" y1="12" x2="22" y2="12" />
                                <line x1="4.93" y1="19.07" x2="7.76" y2="16.24" />
                                <line x1="16.24" y1="7.76" x2="19.07" y2="4.93" />
                            </svg>
                            Analyze with AI
                        </span>
                        <span class="btn-loading" style="display: none;">Analyzing...</span>
                    </button>
                </div>

                <!-- Voice Input Tab -->
                <div class="tab-content" id="voice-tab">
                    <div class="voice-recorder">
                        <div class="voice-status" id="voice-status">
                            <svg class="status-icon" width="48" height="48" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" />
                                <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                                <line x1="12" y1="19" x2="12" y2="23" />
                                <line x1="8" y1="23" x2="16" y2="23" />
                            </svg>
                            <span class="status-text">Click to start recording</span>
                        </div>
                        <button type="button" class="voice-btn" id="voice-record-btn">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"
                                style="vertical-align: middle; margin-right: 5px;">
                                <circle cx="12" cy="12" r="10" />
                            </svg>
                            Start Recording
                        </button>
                        <div id="voice-transcript" class="voice-transcript" style="display: none;"></div>
                    </div>
                    <button type="button" class="ai-analyze-btn" id="analyze-voice-btn" style="display: none;">
                        <span class="btn-text">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" style="vertical-align: middle; margin-right: 5px;">
                                <circle cx="12" cy="12" r="10" />
                                <circle cx="12" cy="12" r="3" />
                                <line x1="12" y1="2" x2="12" y2="6" />
                                <line x1="12" y1="18" x2="12" y2="22" />
                                <line x1="4.93" y1="4.93" x2="7.76" y2="7.76" />
                                <line x1="16.24" y1="16.24" x2="19.07" y2="19.07" />
                                <line x1="2" y1="12" x2="6" y2="12" />
                                <line x1="18" y1="12" x2="22" y2="12" />
                                <line x1="4.93" y1="19.07" x2="7.76" y2="16.24" />
                                <line x1="16.24" y1="7.76" x2="19.07" y2="4.93" />
                            </svg>
                            Analyze with AI
                        </span>
                        <span class="btn-loading" style="display: none;">Analyzing...</span>
                    </button>
                </div>

                <!-- AI Results -->
                <div id="ai-results" class="ai-results" style="display: none;">
                    <div class="ai-results-header">
                        <svg class="ai-icon" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2">
                            <polygon
                                points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />
                        </svg>
                        <h4>AI Analysis Complete</h4>
                    </div>
                    <div class="ai-results-content">
                        <div class="result-item">
                            <strong>Detected Crime Type:</strong>
                            <span id="ai-crime-type" class="crime-badge"></span>
                        </div>
                        <div class="result-item">
                            <strong>Summary:</strong>
                            <p id="ai-summary"></p>
                        </div>
                        <button type="button" class="use-ai-btn" id="use-ai-results-btn">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" style="vertical-align: middle; margin-right: 5px;">
                                <polyline points="20 6 9 17 4 12" />
                            </svg>
                            Use These Results
                        </button>
                    </div>
                </div>
            </div>

            <div class="divider-line"></div>

            <!-- Manual Form Fields -->
            <div class="form-group">
                <label for="incident-type">Who was affected? <span class="required">*</span></label>
                <select id="incident-type" name="incidentType" required>
                    <option value="">Select who was affected</option>
                    <option value="personal">This happened to me personally</option>
                    <option value="other">Someone else / General community report</option>
                </select>
                <small style="color: #666; font-size: 13px; margin-top: 5px; display: block;">
                    If this happened to you, contact information will be required for police follow-up
                </small>
            </div>

            <div class="form-group">
                <label for="crime-type">Crime Type <span class="required">*</span></label>
                <select id="crime-type" name="crimeType" required>
                    <option value="">Select a crime type</option>
                    <option value="Theft">Theft</option>
                    <option value="Burglary">Burglary</option>
                    <option value="Robbery">Robbery</option>
                    <option value="Assault">Assault</option>
                    <option value="Vandalism">Vandalism</option>
                    <option value="Vehicle Theft">Vehicle Theft</option>
                    <option value="Drug Activity">Drug Activity</option>
                    <option value="Fraud">Fraud</option>
                    <option value="Harassment">Harassment</option>
                    <option value="Trespassing">Trespassing</option>
                    <option value="Arson">Arson</option>
                    <option value="Suspicious Activity">Suspicious Activity</option>
                    <option value="Other">Other</option>
                </select>
            </div>

            <div class="form-group">
                <label for="description">Description <span class="required">*</span></label>
                <textarea id="description" name="description" placeholder="Provide details about the incident..."
                    required></textarea>
            </div>

            <div class="form-group">
                <label for="date-time">Date & Time <span class="required">*</span></label>
                <input type="datetime-local" id="date-time" name="dateTime" required>
            </div>

            <div class="form-group">
                <label for="address">Location <span class="required">*</span></label>
                <input type="text" id="address" name="address" placeholder="Enter street address or landmark" required>
                <button type="button" class="location-btn" id="get-location-btn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        style="vertical-align: middle; margin-right: 5px;">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                        <circle cx="12" cy="10" r="3" />
                    </svg>
                    Use My Current Location
                </button>
                <input type="hidden" id="latitude" name="latitude">
                <input type="hidden" id="longitude" name="longitude">
            </div>

            <div class="form-group">
                <label for="witnesses">Witnesses (Optional)</label>
                <input type="text" id="witnesses" name="witnesses" placeholder="Number of witnesses or names">
            </div>

            <div class="form-group">
                <label for="reporter-name">Your Name (Optional)</label>
                <input type="text" id="reporter-name" name="reporterName" placeholder="Anonymous if left blank">
            </div>

            <div class="form-group" id="contact-group">
                <label for="contact">
                    Contact Information
                    <span class="required" id="contact-required" style="display: none;">*</span>
                    <span id="contact-optional">(Optional)</span>
                </label>
                <input type="text" id="contact" name="contact" placeholder="Phone or email for police follow-up">
                <small id="contact-help" style="color: #666; font-size: 13px; margin-top: 5px; display: none;">
                    Required for personal incidents so police can contact you for follow-up
                </small>
            </div>

            <button type="submit" class="submit-btn" id="submit-btn">Submit Report</button>
        </form>
    </div>

    <script type="module">
        import { goToHomeDashboard } from './js/authUtils.js';

        // Home navigation
        document.getElementById('home-link').addEventListener('click', (e) => {
            e.preventDefault();
            goToHomeDashboard();
        });

        document.getElementById('home-btn').addEventListener('click', (e) => {
            e.preventDefault();
            goToHomeDashboard();
        });
    </script>
    <script type="module" src="../js/report.js"></script>
</body>

</html>